# Garbage collectors

## System info:

```
██████████████████  ████████   username@host 
██████████████████  ████████   ---------------- 
██████████████████  ████████   OS: Manjaro Linux x86_64 
██████████████████  ████████   Host: MS-7A68 1.0 
████████            ████████   Kernel: 5.4.15-2-MANJARO 
████████  ████████  ████████   Uptime: 56 mins 
████████  ████████  ████████   Packages: 1488 (pacman) 
████████  ████████  ████████   Shell: bash 5.0.11 
████████  ████████  ████████   DE: Xfce 
████████  ████████  ████████   Terminal: xfce4-terminal 
████████  ████████  ████████   CPU: Intel i5-7400 (4) @ 3.500GHz 
████████  ████████  ████████   GPU: Intel HD Graphics 630 
████████  ████████  ████████   Memory: 7235MiB / 15901MiB 
████████  ████████  ████████   ---------------- 
```

## Conclusions

Запуск эксперимента проводился по каждому из сборщиков мусора с
ограничениями размера хипа в 128/1024/5120 МБ. В зависимости от размера
памяти определяется задежка для sleep активного треда для того, чтобы
приложенеие работало примерно одинаковое время.
- Неожиданно оказалось, что сборщик G1 работал во всех тестах меньше чем
  все остальные.
- G1 как оказалось не резервирует память, при его работе вся область
  память была выделена без ограничений.
- Я почему то ожидал, что в среднем время пауз у Parallel будет ниже,
  чем Serial, как собственно и максимальное. Но по факту все три теста
  показывают обратное. Безусловным лидером по части минимальной задержки
  является G1.
- Продолжительность сборок Serial/Parallel и их распределение более
  равномерное чем у конкурентных сборщиков. CMS делает сборки наиболее
  часто, но они очень короткие. Тем не менее, G1 делает сборки несколько
  реже и большинство из них укладываются в минимальное время , что
  повышает доступность.
- G1 отличает тот факт что полные сборки он делает только практически
  при полном отсутствии свободной памяти, CMS делает полную сборку
  довольно часто, расходуя большое количество ресурсов. Видимо поэтому
  его пометили устаревшим в JDK 9.

Из рассмотренных параметров самым оптимальным является G1.


## GC analytics

### Java heap size 128mb

-----------

#### Duration

| Duration |           Allocated |
|:---------|--------------------:|
| Serial   | 5 min 28 sec 807 ms |
| Parallel | 5 min 13 sec 111 ms |
| CMS      | 5 min 28 sec 701 ms |
| G1       | 4 min 44 sec 216 ms |

#### JVM memory size

| Memory size, mb | Allocated | Peak |
|:----------------|:---------:|:----:|
| Serial          |    123    | 123  |
| Parallel        |    123    | 117  |
| CMS             |    123    | 123  |
| G1              |    128    | 126  |

#### Key Performance Indicators

| KPI      | Throughput, % | Avg Pause GC Time, ms | Max Pause GC Time, ms |
|:---------|:-------------:|:---------------------:|:---------------------:|
| Serial   |    99.853     |         22.0          |         55.3          |
| Parallel |    99.857     |         26.4          |         41.3          |
| CMS      |    99.808     |         3.54          |         50.4          |
| G1       |    99.904     |         4.79          |         27.1          |

#### GC Pause Duration Time Range

| Duration (ms) | Count / % | 0 - 10 | 10 - 20 | 20 - 30 | 30 - 40 | 40 - 50 | 50 - 60 |
|:--------------|:---------:|:------:|:-------:|:-------:|:-------:|:-------:|:-------:|
| Serial        |   count   |   7    |    6    |    1    |    4    |    3    |    1    |
|               |     %     | 31.82  |  27.27  |  4.55   |  18.18  |  13.64  |  4.55   |
| Parallel      |   count   |   1    |    3    |    7    |    5    |    1    |    -    |
|               |     %     |  5.88  |  17.65  |  41.18  |  29.41  |  5.88   |    -    |
| CMS           |   count   |  165   |    3    |    4    |    3    |    2    |    1    |
|               |     %     |  92.7  |  1.69   |  2.25   |  1.69   |  1.12   |  0.56   |
| G1            |   count   |   47   |    7    |    3    |    -    |    -    |    -    |
|               |     %     | 82.46  |  12.28  |  5.26   |    -    |    -    |    -    |

### Java heap size 1024mb

-----------

#### Duration

| Duration |           Allocated |
|:---------|--------------------:|
| Serial   | 5 min 20 sec 808 ms |
| Parallel |  5 min 7 sec 686 ms |
| CMS      | 5 min 20 sec 855 ms |
| G1       | 4 min 53 sec 736 ms |

#### JVM memory size

| Memory size, mb | Allocated | Peak |
|:----------------|:---------:|:----:|
| Serial          |    989    | 989  |
| Parallel        |    981    | 938  |
| CMS             |    990    | 990  |
| G1              |   1024    | 1024 |

#### Key Performance Indicators

| KPI      | Throughput, % | Avg Pause GC Time, ms | Max Pause GC Time, ms |
|:---------|:-------------:|:---------------------:|:---------------------:|
| Serial   |    99.270     |         78.1          |          198          |
| Parallel |    99.142     |          126          |          248          |
| CMS      |    99.319     |         12.4          |          217          |
| G1       |    99.577     |         17.3          |          107          |

#### GC Pause Duration Time Range

| Duration (ms) | Count / % | 0 - 50 | 50 - 100 | 100 - 150 | 150 - 200 | 200 - 250 |
|:--------------|:---------:|:------:|:--------:|:---------:|:---------:|:---------:|
| Serial        |   count   |   14   |    2     |     9     |     5     |     -     |
|               |     %     | 46.67  |   6.67   |   30.0    |   16.67   |     -     |
| Parallel      |   count   |   4    |    4     |     6     |     1     |     6     |
|               |     %     | 19.05  |  19.05   |   28.57   |   4.76    |   28.57   |
| CMS           |   count   |  164   |    2     |     6     |     4     |     1     |
|               |     %     | 92.66  |   1.13   |   3.39    |   2.26    |   0.56    |
| G1            |   count   |   66   |    5     |     1     |     -     |     -     |
|               |     %     | 91.67  |   6.94   |   1.39    |     -     |     -     |

### Java heap size 5120mb

-----------

#### Duration

| Duration |           Allocated |
|:---------|--------------------:|
| Serial   | 5 min 26 sec 302 ms |
| Parallel | 5 min 08 sec 222 ms |
| CMS      | 5 min 28 sec 073 ms |
| G1       | 5 min 26 sec 157 ms |

#### JVM memory size

| Memory size, gb | Allocated | Peak |
|:----------------|:---------:|:----:|
| Serial          |   4.83    | 4.83 |
| Parallel        |   4.79    | 4.58 |
| CMS             |   4.97    | 4.97 |
| G1              |     5     |  5   |

#### Key Performance Indicators

| KPI      | Throughput, % | Avg Pause GC Time, ms | Max Pause GC Time, ms |
|:---------|:-------------:|:---------------------:|:---------------------:|
| Serial   |    96.264     |          359          |          941          |
| Parallel |    96.591     |          404          |          912          |
| CMS      |    97.858     |         61.1          |          741          |
| G1       |    98.771     |         50.7          |          350          |

#### GC Pause Duration Time Range

| Duration (ms) | Count / % | 0 - 100 | 100 - 200 | 200 - 300 | 300 - 400 | 400 - 500 | 500 - 600 | 600 - 700 | 700 - 800 | 800 - 900 | 900 - 1,000 |
|:--------------|:---------:|:-------:|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|:-----------:|
| Serial        |   count   |   16    |     -     |     -     |     1     |     1     |     6     |     5     |     2     |     2     |      1      |
|               |     %     |  47.06  |     -     |     -     |   2.94    |   2.94    |   17.65   |   14.71   |   5.88    |   5.88    |    2.94     |
| Parallel      |   count   |    3    |     1     |     4     |     3     |     5     |     7     |     1     |     1     |     -     |      1      |
|               |     %     |  11.54  |   3.85    |   15.38   |   11.54   |   19.23   |   26.92   |   3.85    |   3.85    |     -     |    3.85     |
| CMS           |   count   |   94    |    10     |     6     |     3     |     1     |     -     |     -     |     1     |     -     |      -      |
|               |     %     |  81.74  |    8.7    |   5.22    |   2.61    |   0.87    |     -     |     -     |   0.87    |     -     |      -      |
| G1            |   count   |   70    |     3     |     4     |     2     |     -     |     -     |     -     |     -     |     -     |      -      |
|               |     %     |  88.61  |    3.8    |   5.06    |   2.53    |     -     |     -     |     -     |     -     |     -     |      -      |
